---
import Button from '@/components/common/Button.astro';
import FinalCarousel from '@/components/studio/FinalCarousel.astro';
import { STUDIO_ZONES_GALLERY } from '@/utils/data/ui-content';

interface Props {
  id: string;
  title: string;
  description: string;
  reverse?: boolean;
  features?: string[];
  idealFor?: string[];
  titleClass?: string;
  descriptionClass?: string;
}

const {
  id,
  title,
  description,
  reverse = false,
} = Astro.props;

// Obtener las imágenes de la zona correspondiente
const getZoneImages = (spaceId: string) => {
  const zoneMap: Record<string, keyof typeof STUDIO_ZONES_GALLERY.zones> = {
    'cyclorama': 'cyclorama',
    'color-backgrounds': 'colorBackgrounds',
    'black-zone': 'blackZone',
    'creative-studio': 'creativeStudio'
  };

  const zoneKey = zoneMap[spaceId];
  return zoneKey ? STUDIO_ZONES_GALLERY.zones[zoneKey] : null;
};

const zoneData = getZoneImages(id);

const getDynamicLayout = (imageCount: number) => {
  if (imageCount <= 2) {
    return {
      columns: { mobile: 1, tablet: 2, desktop: 2 },
      maxImages: imageCount,
      aspectRatio: 'landscape' as const,
      gap: 'lg' as const
    };
  } else if (imageCount <= 4) {
    return {
      columns: { mobile: 2, tablet: 2, desktop: 2 },
      maxImages: imageCount,
      aspectRatio: 'landscape' as const,
      gap: 'md' as const
    };
  } else {
    return {
      columns: { mobile: 2, tablet: 2, desktop: 3 },
      maxImages: 6,
      aspectRatio: 'landscape' as const,
      gap: 'md' as const
    };
  }
};

const dynamicLayout = zoneData ? getDynamicLayout(zoneData.images.length) : STUDIO_ZONES_GALLERY.defaultLayout;
---

<div
  id={id}
  class={`flex flex-col ${reverse ? 'lg:flex-row-reverse' : 'lg:flex-row'} gap-8 lg:gap-12 mb-20 items-center`}
>
  <!-- Galería de imágenes - más grande -->
  <div class="w-full lg:w-3/5">
    {zoneData ? (
      <FinalCarousel
        images={[...zoneData.images]}
        layout={dynamicLayout}
        zone={zoneData.name}
        enableLightbox={true}
        showOverlay={false}
        class="w-full"
      />
    ) : (
      <div class="w-full h-80 bg-gray-100 rounded-xl flex items-center justify-center">
        <p class="text-gray-400">Galería no disponible</p>
      </div>
    )}
  </div>

  <!-- Contenido simplificado -->
  <div class="w-full lg:w-2/5 flex flex-col justify-center">
    <h3 class="text-2xl md:text-3xl font-instrument mb-4 text-primary-black">{title}</h3>
    <p class="text-primary-gray leading-relaxed mb-6">{description}</p>
    <Button
      href="/booking"
      variant="custom"
      class="bg-primary-black text-primary-white hover:bg-primary-beige hover:text-primary-black self-start"
    >
      Reservar
    </Button>
  </div>
</div>
